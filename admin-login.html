<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Login ‚Äî Pharm</title>
  <style>
    :root{--bg:#f5f7fb;--card:#fff;--accent:#0b6efd;--muted:#6b7280}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    body{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#eef2ff 0%,var(--bg) 100%);padding:24px}
    .card{width:100%;max-width:420px;background:var(--card);border-radius:12px;box-shadow:0 6px 30px rgba(16,24,40,.08);padding:28px}
    .logo{display:flex;align-items:center;gap:12px;margin-bottom:8px}
    .logo .mark{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#0ea5e9,#7c3aed);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    h1{font-size:20px;margin:6px 0 0}
    p.lead{color:var(--muted);margin:6px 0 18px;font-size:13px}
    form{display:grid;gap:12px}
    label{font-size:13px;color:#111827}
    .input{display:flex;align-items:center;background:#f8fafc;border:1px solid #e6edf3;padding:10px 12px;border-radius:8px}
    .input input{border:0;background:transparent;outline:none;font-size:15px;width:100%}
    .actions{display:flex;gap:8px;align-items:center;margin-top:6px}
    button.primary{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;border:1px solid #e6edf3;padding:9px 12px;border-radius:10px;color:#374151;cursor:pointer}
    .muted{color:var(--muted);font-size:13px;margin-top:10px}
    .error{color:#b91c1c;background:#fff1f2;padding:8px;border-radius:8px;font-size:13px}
    .helper{display:flex;justify-content:space-between;align-items:center}
    .toggle{background:transparent;border:0;cursor:pointer;padding:6px}
    .small{font-size:12px;color:var(--muted)}
    @media (max-width:480px){.card{padding:20px;margin:8px}}
  </style>
</head>
<body>
  <main class="card" role="main">
    <div class="logo">
      <div class="mark">P</div>
      <div>
        <h1>Pharm Admin</h1>
        <p class="lead">Login to manage products, offers and orders</p>
      </div>
    </div>

    <div id="error" style="display:none" class="error" role="alert"></div>

    <form id="loginForm">
      <div>
        <label for="password">Admin Password</label>
        <div class="input">
          <input id="password" name="password" type="password" placeholder="Enter your admin password" autocomplete="current-password" required />
          <button type="button" class="toggle" id="togglePw" aria-label="Show password">üëÅÔ∏è</button>
        </div>
      </div>

      <div class="helper">
        <div class="small">Default: <strong>admin123</strong></div>
        <a href="index.html" class="small">Back to store</a>
      </div>

      <div class="actions">
        <button type="submit" class="primary" id="submitBtn">Sign in</button>
        <button type="button" class="ghost" id="clearBtn">Clear</button>
      </div>
    </form>

    <div class="muted">Tip: Use a strong ADMIN_PASSWORD environment variable before deploying.</div>
  </main>

  <script>
    const form = document.getElementById('loginForm');
    const pwd = document.getElementById('password');
    const toggle = document.getElementById('togglePw');
    const errorEl = document.getElementById('error');
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');

    toggle.addEventListener('click', () => {
      if (pwd.type === 'password') { pwd.type = 'text'; toggle.textContent = 'üôà'; }
      else { pwd.type = 'password'; toggle.textContent = 'üëÅÔ∏è'; }
    });

    clearBtn.addEventListener('click', () => { pwd.value = ''; pwd.focus(); errorEl.style.display='none'; });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      errorEl.style.display = 'none';
      submitBtn.disabled = true; submitBtn.textContent = 'Signing in...';
      try {
        const res = await fetch('/api/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'same-origin',
          body: JSON.stringify({ password: pwd.value })
        });
        const json = await res.json();
        if (!res.ok) throw new Error(json && json.error ? json.error : 'Login failed');
        // success: redirect to admin UI
        window.location.href = 'admin.html';
      } catch (err) {
        errorEl.textContent = err.message || 'Login failed';
        errorEl.style.display = 'block';
        submitBtn.disabled = false; submitBtn.textContent = 'Sign in';
      }
    });
  </script>
</body>
</html>
